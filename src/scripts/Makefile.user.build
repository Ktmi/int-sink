phony += all

dep-user := $(obj-user:.o=.d)

$(dep-user): %.d: %.c
	$(COMPILE.test.c) $< -M -MT '$(@:.d=.o) $@' > $@

include $(dep-bpf)

all: $(target-exec)

$(target-exec): $(obj-user) $(OBJECT_LIBBPF)
	$(LINK.o) $^ $(LOADLIBES) $(LDLIBS) -o $@

$(obj-user): %.o: %.c $(OBJECT_LIBBPF)
	$(COMPILE.c) $(OUTPUT_OPTION) $<

phony += clean

clean-targets += $(target-exec) $(obj-user) $(dep-user)

clean:
	-rm -f $(clean-targets)

.PHONY: $(phony)

.DELETE_ON_ERROR:

.SECONDARY: