#include "int_remover.xdp.h"
#include "debug/print.h"

int main(int argc, char** argv)
{
    char packet[] = "\x00\x15\x5d\x00\x68\x18\x00\x15\x5d\x00\x68\x03\x08\x00\x45\x5c\x00\x34\x00\x01\x00\x00\x40\x11\xf9\x06\xc0\xa8\x00\x02\xc0\xa8\x00\x03\x17\x0c\x17\x0c\x00\x20\xf5\x37\x01\x00\x03\x28\x10\x00\x06\x0a\xfc\x00\x00\x00\x00\x00\x00\x01\x16\x60\x4e\xdb\x49\xed\x95\xab";

    struct xdp_md xdp_frame = {
        .data = packet,
        .data_end = packet + sizeof(packet) - 1, // subtract 1 to exclude null terminator
    };

    print_xdp_md(&xdp_frame);

    remove_int(&xdp_frame);

    print_xdp_md(&xdp_frame);
}